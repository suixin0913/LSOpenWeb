<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<title data-react-helmet="true">产测开发 | 聆思文档中心</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="产测开发 | 聆思文档中心"><meta data-react-helmet="true" name="description" content="1.说明"><meta data-react-helmet="true" property="og:description" content="1.说明"><meta data-react-helmet="true" property="og:url" content="https://github.com/LISTENAI/factory_config"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/LISTENAI/factory_config"><link rel="stylesheet" href="/styles.16a99837.css">
<link rel="preload" href="/styles.a415eef2.js" as="script">
<link rel="preload" href="/runtime~main.db326cd7.js" as="script">
<link rel="preload" href="/main.6c23daca.js" as="script">
<link rel="preload" href="/1.f5c93ba5.js" as="script">
<link rel="preload" href="/2.60916f76.js" as="script">
<link rel="preload" href="/1a4e3797.db8344af.js" as="script">
<link rel="preload" href="/1be78505.34f4f775.js" as="script">
<link rel="preload" href="/70.8fbb44b1.js" as="script">
<link rel="preload" href="/69.49228842.js" as="script">
<link rel="preload" href="/935f2afb.3167cd55.js" as="script">
<link rel="preload" href="/17896441.e5497843.js" as="script">
<link rel="preload" href="/bf481fa8.558525dc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="LSOpen Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="LSOpen Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">聆思文档中心</strong></a><a class="navbar__item navbar__link" href="/CSK_online_guides_home">离在线开发指南</a><a class="navbar__item navbar__link" href="/csksdk_api">API</a><a class="navbar__item navbar__link" href="/download">下载中心</a><a class="navbar__item navbar__link" href="/lisa">Hello Lisa</a><a class="navbar__item navbar__link" href="/school">视频教程</a></div><div class="navbar__items navbar__items--right"><a href="https://cloud.listenai.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LSCloud</a><div class="navbar__search searchBarContainer_1-U_"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_18Th searchBarLoadingRing_zYFK"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="LSOpen Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="LSOpen Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">聆思文档中心</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/CSK_online_guides_home">离在线开发指南</a></li><li class="menu__list-item"><a class="menu__link" href="/csksdk_api">API</a></li><li class="menu__list-item"><a class="menu__link" href="/download">下载中心</a></li><li class="menu__list-item"><a class="menu__link" href="/lisa">Hello Lisa</a></li><li class="menu__list-item"><a class="menu__link" href="/school">视频教程</a></li><li class="menu__list-item"><a href="https://cloud.listenai.com" target="_blank" rel="noopener noreferrer" class="menu__link">LSCloud</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">产测开发</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1说明"></a>1.说明<a class="hash-link" href="#1说明" title="Direct link to heading">#</a></h2><p>CSK4002/CSK3002 产测模式可以对 CSK4002/CSK3002 核心模组进行基本硬件检测。产测代码和正常代码集成在一个固件里面，CSK4002/CSK3002 芯片上电后通过判断产测触发引脚的状态来决定进入产测或正常运行。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2产测项"></a>2.产测项<a class="hash-link" href="#2产测项" title="Direct link to heading">#</a></h2><p>CSK芯片检测分为音频检测和硬件连通性检测。</p><ol><li><p>音频检测：包括以下两条通路：</p><ul><li>录音通路：MIC 音频经过 ADC 到 CSK 芯片的音频通路</li><li>播音通路：CSK 芯片通过 SPK 播放音频的通路</li></ul></li><li><p>硬件连通性检测：包含 GPIO 的连通性检测。</p></li></ol><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><code>4002纯离线方案</code>与<code>3002纯离线方案</code>产测项有所不同</p><ul><li><p><code>4002音频检测</code>：包括MIC频率检测结果，MIC一致性检测结果，REF 信号检测结果。</p></li><li><p><code>3002音频检测</code>：包括MIC频率检测结果，MIC一致性检测结果。</p></li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="3产测配置"></a>3.产测配置<a class="hash-link" href="#3产测配置" title="Direct link to heading">#</a></h2><p>提供了可供用户配置的产测配置，来适应不同的产测需求。</p><p><code>hardware.toml</code>：可通过该硬件配置文件，配置产测涉及的芯片硬件引脚，如：</p><ul><li>产测触发引脚</li><li>音频检测结果输出引脚</li><li>和其他 GPIO 引脚</li></ul><p><code>application.toml</code>：可通过该软件配置文件，配置产测涉及的产测开关和触发电平，如：</p><ul><li>产测检测开关</li><li>产测触发有效电平</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="31-hardwaretoml"></a>3.1 hardware.toml<a class="hash-link" href="#31-hardwaretoml" title="Direct link to heading">#</a></h3><p><code>hardware.toml</code> 文件的<code>factory_gpio</code>字段就是产测引脚的硬件配置，包含下表 3 个字段:</p><table><thead><tr><th>引脚分类</th><th>说明</th></tr></thead><tbody><tr><td><code>check_enter</code></td><td>产测模式触发检测引脚：通过检测此引脚的电平来决定是否进入产测模式；只能配 1 个引脚，只能为输入</td></tr><tr><td><code>check_record</code></td><td>音频检测结果输出引脚：用来输出音频检测结果（依次为 MIC频率检测结果，MIC一致性检测结果，REF 信号检测结果）；只能配 3 个引 脚，只能为输出</td></tr><tr><td><code>check_gpios</code></td><td>GPIO连通性测试引脚：用来检测 GPIO 的硬件连通性，CSK 会控制这些引脚的电平，最多可配置 10 个引脚， 只能为输出</td></tr></tbody></table><p>下面是其中引脚的字段的说明</p><table><thead><tr><th>键名</th><th>键值</th><th>说明</th></tr></thead><tbody><tr><td><code>tag</code></td><td><code>name</code></td><td>pin脚的名字，用户可指定</td></tr><tr><td><code>pin</code></td><td><code>1~64</code></td><td>CSK芯片的引脚，具体参考Datasheet</td></tr><tr><td><code>mux</code></td><td><code>0~4</code></td><td>pin 脚的复用功能</td></tr><tr><td><code>dir</code></td><td><code>true</code><br><code>false</code></td><td>引脚设置为输出<br>引脚设置为输入</td></tr><tr><td><code>def</code></td><td><code>true</code><br><code>false</code></td><td>当引脚设为输出时，输出的逻辑电平为高<br>当pin脚设为输出时，输出的逻辑电平为低</td></tr><tr><td><code>rev</code></td><td><code>true</code><br><code>false</code></td><td>逻辑电平和物理电平一致<br>逻辑电平和物理电平相反</td></tr></tbody></table><p><code>hardware.toml</code> 的<code>factory_gpio</code>字段示例如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # 通过此引脚来决定是否进入产测模式；</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # 只能配</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">个引脚；</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # 只能为输入dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_enter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;enter&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # 用来输出音频检测结果（依次为 </span><span class="token constant" style="color:rgb(130, 170, 255)">MIC</span><span class="token plain">频率检测结果</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token constant" style="color:rgb(130, 170, 255)">MIC</span><span class="token plain">一致性检测结果</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token constant" style="color:rgb(130, 170, 255)">REF</span><span class="token plain"> 信号检测结果）；只能配</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain">个引脚，只能为输出（dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain">）。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_record</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;record0&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">38</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_record</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;record1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">47</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_record</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;record2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">57</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # 用来检测 </span><span class="token constant" style="color:rgb(130, 170, 255)">GPIO</span><span class="token plain"> 的硬件连通性，</span><span class="token constant" style="color:rgb(130, 170, 255)">CSK</span><span class="token plain"> 控制这些引脚的电平，最多可配置</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">个引脚，只能为输出（dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain">）。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio0&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">46</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">24</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">26</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio4&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">35</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio5&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">55</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio6&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">56</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio7&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">59</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory_gpio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">check_gpios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tag </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpio8&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  pin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">62</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mux </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dir </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rev </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="32-applicationtoml"></a>3.2 application.toml<a class="hash-link" href="#32-applicationtoml" title="Direct link to heading">#</a></h3><p><code>application.toml</code> 的<code>factory</code>字段包含了<code>产测开关</code>以及<code>产测触发电平</code>的配置，如下图：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#产测配置</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">factory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 产测开关，决定上电是否进行产测模式检测。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">enable </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 注意：只有产测开关打开，才会进行产测模式检查，从而有可能进入产测模式。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 如果产测开关关闭，即便配置了产测其他字段，流程上实际也不会用到。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 检查进入产测模式的触发电平条件，</span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain">：低电平；</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain">：高电平。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">check_enter_level </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 预留配置，暂未使用。检测进入产测模式触发电平的延迟时间。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">check_gpios_delay </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="4产线烧录流程"></a>4.产线烧录流程<a class="hash-link" href="#4产线烧录流程" title="Direct link to heading">#</a></h2><p>产线烧录流程包括<code>固件烧录</code>和<code>SN烧录</code>，均在<code>CastorFactoryTool</code>量产工具上完成。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="41-获取量产包"></a>4.1 获取量产包<a class="hash-link" href="#41-获取量产包" title="Direct link to heading">#</a></h3><p>用户可从LStudio工程根目录<code>release</code>目录获取到量产包<code>release.zip</code>
<img src="/assets/images/1614685884552-551f011962f09ab3f09a15d1f1593ca3.png"></p><p>将<code>release.zip</code>解压，解压后的目录中找到量产固件包，量产固件包的命名规则为<code>项目名-版本号-factory.csk</code></p><p><img src="/assets/images/1614763016767-cc71ed097559fb8db2399e17a96fb7c8.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="42-打开量产烧录工具"></a>4.2 打开量产烧录工具<a class="hash-link" href="#42-打开量产烧录工具" title="Direct link to heading">#</a></h3><p><img src="/assets/images/1614686136267-bea489164dd2a123f4b434f23abf60fe.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="43-安装usb驱动"></a>4.3 安装USB驱动<a class="hash-link" href="#43-安装usb驱动" title="Direct link to heading">#</a></h3><p><img src="/assets/images/1614686244775-47f45d861625fa30ae44f766d17de57b.png">
<img src="/assets/images/1614686264149-a4c7f8fa2082ba042beb22e95316ce59.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="44-选择usb烧录"></a>4.4 选择USB烧录<a class="hash-link" href="#44-选择usb烧录" title="Direct link to heading">#</a></h3><p><img src="/assets/images/1614686289984-d8dbac213d4ffc810da1b48306574b56.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="45-选择并导入量产固件包"></a>4.5 选择并导入量产固件包<a class="hash-link" href="#45-选择并导入量产固件包" title="Direct link to heading">#</a></h3><p><img src="/assets/images/1614762594992-79a799ceae056146f83fd43ba2945d90.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="46-准备sn序列号文件"></a>4.6 准备SN序列号文件<a class="hash-link" href="#46-准备sn序列号文件" title="Direct link to heading">#</a></h3><p>SN序列号列表文件格式说明如下:</p><ol><li>SN列表采用以半角<code>,</code>分隔的<code>.csv</code>文件储存</li><li>每行存一个SN号，共两列信息：<ul><li>列1：SN号，列1的字符串格式为<code>键值对</code>的形式，一个合法的SN号格式应为<code>SN={SN号};</code><ul><li>键：<code>SN</code></li><li>键值：<code>{SN号}</code></li><li>键值对分割符：半角的<code>;</code>表示结束，作为键值对分割符。</li></ul></li><li>列2：SN号烧录标志位，表示是否已经烧录<ul><li>0（表示未烧录）</li><li>1（表示已烧录）</li></ul></li></ul></li><li>每行以Windows下的CRLF结尾。</li></ol><p>示例：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0001</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">,0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0002</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">,0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>当SN1被烧录后，文件内容变为：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0001</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">,1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0002</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">,0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>一个符合标准的<code>SN.csv</code>文件内容如下图：
<img src="/assets/images/1614687828568-3b1ed93f90bafc51270a42f5920dc121.png"></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>注意：原始的.csv必须包含两列，且列2的取值是0，以用于占位</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="47-导入sn序列号文件"></a>4.7 导入SN序列号文件<a class="hash-link" href="#47-导入sn序列号文件" title="Direct link to heading">#</a></h3><p><img src="/assets/images/1614686772552-5ba902e26cd2278c18d21245370636d5.png">
<img src="/assets/images/1614687997155-e21523ed71e9f8c0d66823ebb7bec696.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="48-填写sn烧录地址"></a>4.8 填写SN烧录地址<a class="hash-link" href="#48-填写sn烧录地址" title="Direct link to heading">#</a></h3><ul><li>3002的SN烧录地址为<code>0x3ff000</code>(4M Flash中最后一页，共计4K空间)</li><li>4002的SN烧录地址为<code>0x7ff000</code>(8M Flash中最后一页，共计4K空间)</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="49-开始烧录"></a>4.9 开始烧录<a class="hash-link" href="#49-开始烧录" title="Direct link to heading">#</a></h3><p><img src="/assets/images/1614688581999-516fa6a0865fd1b18630c913602e71bd.png">
<img src="/assets/images/1614688617339-ce6a486f481f099ada4bc74ff7815b4d.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="410-烧录完成"></a>4.10 烧录完成<a class="hash-link" href="#410-烧录完成" title="Direct link to heading">#</a></h3><p><img src="/assets/images/1614688651062-7d32d682afcfd2661bd0e0b53bee2131.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="5产测流程"></a>5.产测流程<a class="hash-link" href="#5产测流程" title="Direct link to heading">#</a></h2><p>产线烧录流程结束之后，接下来一般会进行产测流程，以管控生产质量。</p><p><code>CSK4002/CSK3002</code>核心模组的产测流程如下：</p><ol><li>上电检测产测触发引脚<code>check_enter</code>，如果检测电平状态为<code>check_enter_level</code>设置的电平，就进入产测模式</li><li>进入产测模式后，打印当前的固件版本</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">taskcreate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">log_task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">00017</span><span class="token plain">cc0</span><span class="token operator" style="color:rgb(137, 221, 255)">~</span><span class="token number" style="color:rgb(247, 140, 108)">0001</span><span class="token plain">bcc0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CSK</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">COMMIT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">pub</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token number" style="color:rgb(247, 140, 108)">.1</span><span class="token plain">@</span><span class="token number" style="color:rgb(247, 140, 108)">92</span><span class="token plain">d9912</span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain">CAE@</span><span class="token number" style="color:rgb(247, 140, 108)">3002.</span><span class="token plain">B3001</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">v1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">beta1</span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain">ESR@</span><span class="token number" style="color:rgb(247, 140, 108)">3002.1210</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">V2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">beta1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">VER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">pub</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token number" style="color:rgb(247, 140, 108)">.1</span><span class="token plain">@</span><span class="token number" style="color:rgb(247, 140, 108)">92</span><span class="token plain">d9912</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">C00000001</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">V4658</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">P3143</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">R7468009D00</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="3"><li><p>顺序执行产测项</p><ul><li><p>音频检测: 通过自播自录，自动通过 SPK 播放音频，同时通过 <code>2 个 MIC</code> 和 <code>回采信号</code> 进行录音</p><ul><li><p>如果 <code>MIC频率</code> 检测通过，则相应引脚设置为逻辑高，否则为逻辑低</p></li><li><p>如果 <code>MIC一致性</code> 检测通过，则相应引脚设置为逻辑高，否则为逻辑低</p></li><li><p>如果 <code>回采信号</code> 检测通过，则相应引脚设置为逻辑高，否则为逻辑低</p></li><li><p>音频检测完成后，通过<code>日志串口</code>输出<code>音频检测结果</code>和<code>SN</code>号 （以CSK3002音频产测结果为例）</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">Frequency Check</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">PASS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">Two Mic Same</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">PASS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">SN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">abcd1234</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li><li><p>当<code>音频检测结果</code>均为<code>PASS</code>并且<code>SN</code>不为空，认为产测通过，通过串口日志输出最终产测结果</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">########################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ######     ##     #####   #####   ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##   ##   ####   ##   ## ##   ##  ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##   ##  ##  ##  ##      ##       ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ######  ##    ##  #####   #####   ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##      ########      ##      ##  ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##      ##    ## ##   ## ##   ##  ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##      ##    ##  #####   #####   ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">########################################</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li><li><p>当<code>音频检测结果</code>有一项为<code>FAIL</code>或者<code>SN</code>为空，认为产测失败，通过串口日志输出最终产测结果</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">########################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  #######    ##    ######  ##       ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##        ####     ##    ##       ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##       ##  ##    ##    ##       ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  #####   ##    ##   ##    ##       ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##      ########   ##    ##       ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##      ##    ##   ##    ##       ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##  ##      ##    ## ######  #######  ##</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">########################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ul></li><li><p>硬件通断性检测: 对<code>check_gpios</code>中配置的GPIO引脚的默认逻辑电平取反</p></li></ul></li></ol></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1说明" class="table-of-contents__link">1.说明</a></li><li><a href="#2产测项" class="table-of-contents__link">2.产测项</a></li><li><a href="#3产测配置" class="table-of-contents__link">3.产测配置</a><ul><li><a href="#31-hardwaretoml" class="table-of-contents__link">3.1 hardware.toml</a></li><li><a href="#32-applicationtoml" class="table-of-contents__link">3.2 application.toml</a></li></ul></li><li><a href="#4产线烧录流程" class="table-of-contents__link">4.产线烧录流程</a><ul><li><a href="#41-获取量产包" class="table-of-contents__link">4.1 获取量产包</a></li><li><a href="#42-打开量产烧录工具" class="table-of-contents__link">4.2 打开量产烧录工具</a></li><li><a href="#43-安装usb驱动" class="table-of-contents__link">4.3 安装USB驱动</a></li><li><a href="#44-选择usb烧录" class="table-of-contents__link">4.4 选择USB烧录</a></li><li><a href="#45-选择并导入量产固件包" class="table-of-contents__link">4.5 选择并导入量产固件包</a></li><li><a href="#46-准备sn序列号文件" class="table-of-contents__link">4.6 准备SN序列号文件</a></li><li><a href="#47-导入sn序列号文件" class="table-of-contents__link">4.7 导入SN序列号文件</a></li><li><a href="#48-填写sn烧录地址" class="table-of-contents__link">4.8 填写SN烧录地址</a></li><li><a href="#49-开始烧录" class="table-of-contents__link">4.9 开始烧录</a></li><li><a href="#410-烧录完成" class="table-of-contents__link">4.10 烧录完成</a></li></ul></li><li><a href="#5产测流程" class="table-of-contents__link">5.产测流程</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 安徽聆思智能科技有限公司皖ICP备05001217号</div></div></div></footer></div>
<script src="/styles.a415eef2.js"></script>
<script src="/runtime~main.db326cd7.js"></script>
<script src="/main.6c23daca.js"></script>
<script src="/1.f5c93ba5.js"></script>
<script src="/2.60916f76.js"></script>
<script src="/1a4e3797.db8344af.js"></script>
<script src="/1be78505.34f4f775.js"></script>
<script src="/70.8fbb44b1.js"></script>
<script src="/69.49228842.js"></script>
<script src="/935f2afb.3167cd55.js"></script>
<script src="/17896441.e5497843.js"></script>
<script src="/bf481fa8.558525dc.js"></script>
</body>
</html>